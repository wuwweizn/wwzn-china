<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>YesPlayMusic</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
        }
        .container {
            text-align: center;
            max-width: 500px;
            padding: 2rem;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        .logo { font-size: 4rem; margin-bottom: 1rem; }
        .title { font-size: 2.5rem; margin-bottom: 1rem; font-weight: 300; }
        .subtitle { font-size: 1.2rem; opacity: 0.8; margin-bottom: 2rem; }
        .status {
            background: rgba(255,255,255,0.2);
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 0.5rem;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .features {
            text-align: left;
            margin: 2rem 0;
            background: rgba(255,255,255,0.1);
            padding: 1.5rem;
            border-radius: 10px;
        }
        .features h3 {
            margin-bottom: 1rem;
            text-align: center;
        }
        .features ul {
            list-style: none;
        }
        .features li {
            margin: 0.5rem 0;
            padding-left: 1rem;
            position: relative;
        }
        .features li::before {
            content: "âœ…";
            position: absolute;
            left: 0;
        }
        .btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            margin: 0.5rem;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
        }
        .btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        .api-status {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ğŸµ</div>
        <h1 class="title">YesPlayMusic</h1>
        <p class="subtitle">é«˜é¢œå€¼çš„ç¬¬ä¸‰æ–¹ç½‘æ˜“äº‘æ’­æ”¾å™¨</p>
        
        <div class="status" id="status">
            <div class="loading"></div>
            æ­£åœ¨å¯åŠ¨éŸ³ä¹æœåŠ¡...
        </div>
        
        <div class="features">
            <h3>ğŸ¶ åŠŸèƒ½ç‰¹è‰²</h3>
            <ul>
                <li>ç½‘æ˜“äº‘è´¦å·ç™»å½•</li>
                <li>æ”¯æŒ MV æ’­æ”¾</li>
                <li>æ­Œè¯æ˜¾ç¤º</li>
                <li>ç§äºº FM / æ¯æ—¥æ¨è</li>
                <li>éŸ³ä¹äº‘ç›˜</li>
                <li>æ·±è‰²/æµ…è‰²ä¸»é¢˜</li>
                <li>æ— ç¤¾äº¤åŠŸèƒ½å¹²æ‰°</li>
                <li>æ”¯æŒæµ·å¤–è®¿é—®</li>
            </ul>
        </div>
        
        <div>
            <a href="#" onclick="checkService()" class="btn">ğŸ”„ é‡æ–°æ£€æŸ¥æœåŠ¡</a>
            <a href="/api/ping" target="_blank" class="btn">ğŸ”— æµ‹è¯•APIè¿æ¥</a>
        </div>
        
        <div class="api-status" id="api-status">
            APIçŠ¶æ€: æ£€æŸ¥ä¸­...
        </div>
    </div>

    <script>
        let checkCount = 0;
        const maxChecks = 30;
        
        function checkService() {
            checkCount++;
            const status = document.getElementById('status');
            const apiStatus = document.getElementById('api-status');
            
            // æ£€æŸ¥ä¸»åº”ç”¨
            fetch('/')
                .then(response => {
                    if (response.ok) {
                        const html = response.text();
                        return html;
                    }
                    throw new Error('Service not ready');
                })
                .then(html => {
                    if (html && html.includes('YesPlayMusic') && html.length > 1000) {
                        status.innerHTML = 'âœ… æœåŠ¡å·²å¯åŠ¨ï¼Œæ­£åœ¨è·³è½¬...';
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000);
                        return;
                    }
                    throw new Error('App not fully loaded');
                })
                .catch(error => {
                    if (checkCount < maxChecks) {
                        status.innerHTML = `<div class="loading"></div>æœåŠ¡å¯åŠ¨ä¸­... (${checkCount}/${maxChecks})`;
                        setTimeout(checkService, 2000);
                    } else {
                        status.innerHTML = 'âš ï¸ æœåŠ¡å¯åŠ¨è¶…æ—¶ï¼Œè¯·æ£€æŸ¥é…ç½®æˆ–é‡å¯åŠ è½½é¡¹';
                    }
                });
            
            // æ£€æŸ¥API
            fetch('/api/ping')
                .then(response => {
                    if (response.ok) {
                        apiStatus.innerHTML = 'APIçŠ¶æ€: âœ… è¿æ¥æ­£å¸¸';
                    } else {
                        apiStatus.innerHTML = 'APIçŠ¶æ€: âš ï¸ è¿æ¥å¼‚å¸¸';
                    }
                })
                .catch(error => {
                    apiStatus.innerHTML = 'APIçŠ¶æ€: âŒ è¿æ¥å¤±è´¥';
                });
        }
        
        // é¡µé¢åŠ è½½åå¼€å§‹æ£€æŸ¥
        setTimeout(checkService, 1000);
        
        // å®šæœŸæ£€æŸ¥æœåŠ¡çŠ¶æ€
        const interval = setInterval(() => {
            if (checkCount >= maxChecks) {
                clearInterval(interval);
            } else {
                checkService();
            }
        }, 5000);
    </script>
</body>
</html>