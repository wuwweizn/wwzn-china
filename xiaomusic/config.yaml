# ============================================================
# Home Assistant Add-on: XiaoMusic
# 使用小爱音箱播放音乐，音乐使用 yt-dlp 下载
# 上游项目: https://github.com/hanxi/xiaomusic
# ============================================================

name: XiaoMusic
version: "0.3.101"
slug: xiaomusic
description: 使用小爱音箱播放音乐，音乐使用 yt-dlp 下载。支持语音口令播放本地/在线音乐。
url: https://github.com/hanxi/xiaomusic

# 使用自有仓库构建的镜像
# 镜像格式: ghcr.io/<owner>/xiaomusic-<arch>:<version>
# 以下 image 字段会被 HA 根据设备架构自动选择对应 arch
image: "ghcr.io/wuwweizn/xiaomusic-{arch}"

# HA 支持的架构列表
arch:
  - amd64
  - aarch64
  - armv7

# 启动方式
startup: application
boot: auto

# 网络端口映射
# 容器内部固定使用 8090，对外映射端口由 host_port 决定
ports:
  8090/tcp: 58090
ports_description:
  8090/tcp: "XiaoMusic Web 管理界面"

# 主机网络（小爱音箱局域网发现需要）
host_network: false

# 数据卷挂载
map:
  - type: media
    read_only: false
  - type: config
    read_only: false

# 用户可配置选项
options:
  music_path: "/media/xiaomusic/music"
  conf_path: "/config/xiaomusic"
  public_port: 58090
  xiaomusic_hostname: ""

schema:
  music_path: str
  conf_path: str
  public_port: int
  xiaomusic_hostname: str?

# 环境变量（由 run.sh 读取 options 并注入）
environment:
  XIAOMUSIC_PUBLIC_PORT: "58090"

# 面板入口（可选，在 HA 侧边栏显示）
panel_icon: mdi:music-note
panel_title: XiaoMusic

# 加载项说明
homeassistant_api: false
hassio_api: false
hassio_role: default
auth_api: false
ingress: true
ingress_port: 8090
ingress_stream: false

# 日志
log_level: info
