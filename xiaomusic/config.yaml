name: "XiaoMusic"
version: "0.4.16"
slug: "xiaomusic"
description: "使用小爱音箱播放音乐，音乐使用 yt-dlp 下载，支持语音口令控制。"
url: "https://github.com/hanxi/xiaomusic"
panel_icon: "mdi:music-box"

# HA 根据当前设备架构自动拼接镜像名
image: "ghcr.io/wuwweizn/xiaomusic-{arch}"

arch:
  - amd64
  - aarch64
  - armv7

startup: "application"
boot: "manual"
init: false

# 端口映射
ports:
  8090/tcp: 58090
ports_description:
  8090/tcp: "XiaoMusic Web 管理后台"

# Web UI 快捷入口（在 HA 侧边栏点击"打开 Web UI"直接跳转）
webui: "http://[HOST]:[PORT:8090]/"

# ── 目录映射 ─────────────────────────────────────────────────────
# media  → /media  （HA 的媒体库目录，推荐存放音乐）
# share  → /share  （HA 的共享目录，也可存放音乐）
# config → /config （HA 的配置目录，存放 xiaomusic 配置文件）
map:
  - "media:rw"
  - "share:rw"
  - "config:rw"

# ── 用户可配置项 ──────────────────────────────────────────────────
# song_media:    /media 下的子目录名，例如填 "music" 则读取 /media/music
# song_share:    /share 下的子目录名，例如填 "music" 则读取 /share/music
# song_download: /share 下的子目录名，用于存放自动下载的歌曲
# public_port:   对外访问端口（需与上方 ports 的映射端口一致）
options:
  song_media: "music"
  song_share: ""
  song_download: "xiaomusic_download"
  public_port: 58090

schema:
  song_media: "str?"
  song_share: "str?"
  song_download: "str?"
  public_port: int

# 固定环境变量
environment:
  XIAOMUSIC_PUBLIC_PORT: "58090"
