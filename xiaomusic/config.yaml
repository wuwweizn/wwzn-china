# =====================================================================
# XiaoMusic - Home Assistant Add-on 配置文件
# 仓库: https://github.com/wuwweizn/wwzn-china
# =====================================================================

name: XiaoMusic
version: "0.3.101"
slug: xiaomusic
description: "使用小爱音箱播放音乐，音乐使用 yt-dlp 下载。支持语音口令控制播放本地及在线音乐。"
url: "https://github.com/hanxi/xiaomusic"
codenotary: false

# ----------------------------------------------------------------
# 使用自有仓库构建好的多架构镜像（由 GitHub Actions 自动构建推送）
# image 字段告诉 HA 直接拉取此镜像，不再本地构建 Dockerfile
# ----------------------------------------------------------------
image: "ghcr.io/wuwweizn/xiaomusic-{arch}"

# 支持的架构（与 GitHub Actions 构建矩阵对应）
arch:
  - amd64
  - aarch64
  - armv7

# ----------------------------------------------------------------
# 端口映射
# 8090 是容器内部端口（不要修改），对外暴露可自定义
# ----------------------------------------------------------------
ports:
  8090/tcp: 58090

ports_description:
  8090/tcp: "XiaoMusic Web 管理后台"

# ----------------------------------------------------------------
# 持久化存储
# /app/music  - 音乐文件存放目录
# /app/conf   - 配置文件存放目录
# ----------------------------------------------------------------
map:
  - type: media
    path: /app/music
    read_only: false
  - type: config
    path: /app/conf
    read_only: false

# ----------------------------------------------------------------
# 环境变量（可在加载项选项中覆盖）
# ----------------------------------------------------------------
environment:
  XIAOMUSIC_PUBLIC_PORT: "58090"

# ----------------------------------------------------------------
# 加载项选项（用户可在 HA 界面配置）
# ----------------------------------------------------------------
options:
  public_port: 58090

schema:
  public_port: int

# ----------------------------------------------------------------
# 网络 & 权限
# ----------------------------------------------------------------
host_network: false
privileged: false
full_access: false
apparmor: false

# ----------------------------------------------------------------
# 显示信息
# ----------------------------------------------------------------
homeassistant_api: false
hassio_api: false
hassio_role: default
auth_api: false
ingress: false

startup: application
boot: manual

# ----------------------------------------------------------------
# UI 信息
# ----------------------------------------------------------------
panel_icon: mdi:music
panel_title: XiaoMusic

# ----------------------------------------------------------------
# 更新日志（首次）
# ----------------------------------------------------------------
changelog: "https://github.com/hanxi/xiaomusic/blob/main/CHANGELOG.md"