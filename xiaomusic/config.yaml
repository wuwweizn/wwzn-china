name: XiaoMusic
version: "0.3.101"
slug: xiaomusic
description: >-
  使用小爱音箱播放音乐，音乐使用 yt-dlp 下载。让小爱音箱无限播放本地及在线音乐。
url: https://github.com/hanxi/xiaomusic
arch:
  - amd64
  - aarch64
  - armv7

# 指向你自有仓库构建并推送到 GHCR 的镜像
# {arch} 会由 Supervisor 自动替换为 amd64 / aarch64 / armv7
image: ghcr.io/wuwweizn/xiaomusic-{arch}

ports:
  8090/tcp: 58090

ports_description:
  8090/tcp: "XiaoMusic Web UI 访问端口"

# 持久化数据目录
map:
  - type: share
    read_only: false
    path: /share/xiaomusic/music
  - type: config
    read_only: false

# 启动选项（可在 HA 加载项页面配置）
options:
  public_port: 58090

schema:
  public_port: int

# 环境变量传递给容器
environment:
  XIAOMUSIC_PUBLIC_PORT: "{{public_port}}"

# 不使用 HA 的 init 系统，xiaomusic 自带 supervisord
init: false

# Web UI（可选，通过 Ingress 访问）
ingress: true
ingress_port: 8090
panel_icon: mdi:music-note

homeassistant: "2023.1.0"