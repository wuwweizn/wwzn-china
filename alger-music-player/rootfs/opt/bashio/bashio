#!/bin/bash

# 简化的 bashio 日志函数
bashio::log.info() {
    echo "[$(date +'%Y-%m-%d %H:%M:%S')] INFO: $*"
}

bashio::log.error() {
    echo "[$(date +'%Y-%m-%d %H:%M:%S')] ERROR: $*" >&2
}

bashio::log.warning() {
    echo "[$(date +'%Y-%m-%d %H:%M:%S')] WARNING: $*" >&2
}

# 配置读取函数
bashio::config() {
    local key="$1"
    local default="$2"
    
    # 从环境变量中读取配置
    case "$key" in
        "music_api_url")
            echo "${MUSIC_API_URL:-$default}"
            ;;
        "log_level")
            echo "${LOG_LEVEL:-$default}"
            ;;
        *)
            echo "$default"
            ;;
    esac
}

# 检查函数是否存在，如果不存在则使用我们的实现
if ! command -v bashio::log.info >/dev/null 2>&1; then
    # 导出函数供其他脚本使用
    export -f bashio::log.info
    export -f bashio::log.error  
    export -f bashio::log.warning
    export -f bashio::config
fi